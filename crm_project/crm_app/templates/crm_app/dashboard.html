{% extends 'crm_app/base.html' %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <h1>Panel Główny</h1>

    {% if perms.crm_app.add_klient %}
        <a href="{% url 'dodaj-klienta' %}" class="btn btn-primary">Dodaj Klienta</a>
    {% endif %}
    {% if perms.crm_app.add_zamowienie %}
        <a href="{% url 'dodaj-zamowienie' %}" class="btn btn-primary">Dodaj Zamówienie</a>
    {% endif %}

    <h2 class="mt-4">Lista Klientów</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Imię i Nazwisko</th>
                <th>E-mail</th>
                <th>Akcje</th>
            </tr>
        </thead>
        <tbody>
            {% for klient in klienci %}
                <tr>
                    <td>{{ klient.imie }} {{ klient.nazwisko }}</td>
                    <td>{{ klient.email }}</td>
                    <td>
                        {% if perms.crm_app.change_klient %}
                            <a href="{% url 'edytuj-klienta' klient.id %}" class="btn btn-sm btn-warning">Edytuj</a>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="3">Brak klientów.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2 class="mt-4">Lista Zamówień</h2>
    <table class="table">
        <thead>
            <tr>
                <th>ID Zamówienia</th>
                <th>Klient</th>
                <th>Status</th>
                <th>Kwota</th>
                <th>Akcje</th>
            </tr>
        </thead>
        <tbody>
            {% for zamowienie in zamowienia %}
                <tr
                    {% if zamowienie.status == 'w_realizacji' %}
                        class="table-warning"
                    {% elif zamowienie.status == 'anulowane' %}
                        class="table-danger"
                    {% elif zamowienie.status == 'zrealizowane' %}
                        class="table-success"
                    {% endif %}
                >
                    <td>{{ zamowienie.id }}</td>
                    <td>{{ zamowienie.klient }}</td>
                    <td>{{ zamowienie.get_status_display }}</td>
                    <td>{{ zamowienie.kwota }}</td>
                    <td>
                        {% if perms.crm_app.change_zamowienie %}
                            <a href="{% url 'edytuj-zamowienie' zamowienie.id %}" class="btn btn-sm btn-warning">Edytuj</a>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5">Brak zamówień.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
